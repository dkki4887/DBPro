<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mapper.OrderMapper">
    <resultMap id="result" type="persistence.dto.OrderDTO">
        <result property="order_id" column="order_id"/>
        <result property="user_id" column="user_id"/>
        <result property="store_id" column="store_id"/>
        <result property="order_price" column="order_price"/>
        <result property="order_payment" column="order_payment"/>
        <result property="order_state" column="order_state"/>
        <result property="order_orderTime" column="order_orderTime"/>
        <result property="order_receiveTime" column="order_receiveTime"/>
    </resultMap>

    <select id="selectAll" resultMap="orderResult">
        SELECT * FROM project.order
    </select>

    <select id="findOrderWithCustomerIdLike" resultMap="orderResult">
        SELECT * FROM project.order
        WHERE (customer_id = #{customer_id} AND state = '취소')
        OR (customer_id = #{customer_id} AND state = '배달완료')
    </select>

    <insert id="insertOrder" parameterType="OrderDTO" useGeneratedKeys="true"
            keyProperty="order_id">
        INSERT INTO project.order (order_id , customer_id , store_id , price , type , date , date2 , state)
        VALUES (#{order_id},#{customer_id},#{store_id},#{price},#{type},#{date},#{date2},#{state})
    </insert>

    <select id="findOrderWithStoreIdLike" resultMap="orderResult">
        SELECT *
        FROM project.order
        WHERE store_id = #{store_id}
    </select>

    <select id="findOrderWithOrderID" resultMap="orderResult">
        SELECT *
        FROM project.order
        WHERE order_id = #{order_id}
    </select>

</mapper>
